From: Markus Koschany <apo@debian.org>
Date: Wed, 29 Aug 2018 07:49:27 +0200
Subject: CVE-2018-14598

Origin: https://cgit.freedesktop.org/xorg/lib/libX11/commit/?id=e83722768fd5c467ef61fa159e8c6278770b45c2
---
 src/GetFPath.c | 5 +++++
 src/ListExt.c  | 5 +++++
 2 files changed, 10 insertions(+)

diff --git a/src/GetFPath.c b/src/GetFPath.c
index c99174a..c156068 100644
--- a/src/GetFPath.c
+++ b/src/GetFPath.c
@@ -78,6 +78,11 @@ char **XGetFontPath(
 		    length = *(unsigned char *)ch;
 		    *ch = '\0'; /* and replace with null-termination */
 		    count++;
+		} else if (i == 0) {
+		    Xfree(flist);
+		    Xfree(ch);
+		    flist = NULL;
+		    break;
 		} else
 		    flist[i] = NULL;
 	    }
diff --git a/src/ListExt.c b/src/ListExt.c
index 6daa14d..11de6f1 100644
--- a/src/ListExt.c
+++ b/src/ListExt.c
@@ -83,6 +83,11 @@ char **XListExtensions(
 		    length = *(unsigned char *)ch;
 		    *ch = '\0'; /* and replace with null-termination */
 		    count++;
+		} else if (i == 0) {
+		    Xfree(list);
+		    Xfree(ch);
+		    list = NULL;
+		    break;
 		} else
 		    list[i] = NULL;
 	    }
